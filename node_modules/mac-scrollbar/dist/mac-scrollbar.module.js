import t,{useCallback as e,useEffect as n,useRef as r,memo as o,useMemo as c,useState as i,useImperativeHandle as l,forwardRef as s}from"react";import{createPortal as a}from"react-dom";function u(){return"undefined"!=typeof navigator}function m(t){return t?"hidden":"auto"}function d(t,e){for(const n in e)t.style[n]=e[n]+"px"}function p(t,e,n,r){void 0===r&&(r=20);const o=e-n,c=Math.max(r,o/t*o);return{thumbSize:c,ratio:(o-c)/(t-e)}}function f(t,e,n){t&&(n?t.scrollLeft=e:t.scrollTop=e)}function h(t){const e=r(t);return e.current=t,e}function S(t,e,r){const o=h(e);n(()=>{function e(t){o.current(t)}return t&&window.addEventListener(t,e,r),()=>{t&&window.removeEventListener(t,e)}},[t])}function g(t,o){let{leading:c=!1,maxWait:i,wait:l=i||0}=o;const s=h(t),a=r(0),u=r(),m=()=>u.current&&clearTimeout(u.current);return n(()=>()=>{a.current=0,m()},[l,i,c]),e(function(){var t=[].slice.call(arguments);const e=Date.now();function n(){a.current=e,m(),s.current.apply(null,t)}const r=a.current,o=e-r;if(0===r){if(c)return void n();a.current=e}if(void 0!==i){if(o>i)return void n()}else o<l&&(a.current=e);m(),u.current=setTimeout(()=>{n(),a.current=0},l)},[l,i,c])}var b=o(function(e){let{visible:n,isGlobal:r,trackStyle:o,thumbStyle:c,minThumbSize:i,start:l,gap:s,horizontal:a,pin:u,trackRef:m,boxSize:d,update:h}=e;const{CW:S,CH:g,PT:b,PR:v,PB:y,PL:k,SW:w,SH:E}=d,[T,L,W]=a?["width",S,w]:["height",g,E];function C(){var t,e;const n=null==(t=m.current)||null==(e=t.parentNode)?void 0:e.parentNode;return n===document.body?document.documentElement:n}const H={...r?{[T]:s>0?"calc(100% - "+s+"px)":void 0}:{[T]:L-s,...a?{bottom:-y,left:-k+l}:{top:b-s+l,right:-v,transform:"translateY(-100%)"}},...o&&o(a)};return t.createElement("div",{className:"ms-track"+(a?" ms-x":" ms-y")+(u?" ms-active":n?" ms-track-show":""),onClick:function(t){const e=C(),{scrollLeft:n,scrollTop:r}=e,o=a?n:r,c=t.target.getBoundingClientRect();f(e,(a?(t.clientX-c.left)/c.width:(t.clientY-c.top)/c.height)>o/W?Math.min(W,o+L):Math.max(0,o-L),a)},ref:m,style:H},t.createElement("div",{className:"ms-thumb",draggable:"true",onDragStartCapture:t=>{t.stopPropagation(),t.preventDefault()},onMouseDown:function(t){t.stopPropagation();const{scrollLeft:e,scrollTop:n}=C();h({pinX:a,pinY:!a,lastST:n,lastSL:e,startX:t.clientX,startY:t.clientY})},onClick:t=>t.stopPropagation(),style:{[T]:p(W,L,s,i).thumbSize,...c&&c(a)}}))});const v={CW:0,SW:0,CH:0,SH:0,PT:0,PR:0,PB:0,PL:0},y={pinX:!1,pinY:!1,lastST:0,lastSL:0,startX:0,startY:0};function k(e,o){let{trackGap:l=16,trackStyle:s,thumbStyle:a,minThumbSize:u,suppressAutoHide:m}=o;const h=e===window,k=c(()=>h?{current:document.documentElement}:e,[h,e]),w=r(null),E=r(null),[T,L]=i(v),[W,C]=i(y),[H,P]=i(!0),Y=()=>!m&&P(!1),z=g(Y,{wait:1e3}),{CW:X,SW:x,CH:R,SH:M}=T,N=x-X>0,A=M-R>0,[G,B,D,I]=function(t,e){if(Array.isArray(t)){const[e,n,r,o]=t;return[e,e+n,r,r+o]}const n=e?t:0;return[0,n,0,n]}(l,N&&A),F=g(()=>{P(!0),z(),function(t,e,n,r,o,c){if(!t)return;const{scrollTop:i,scrollLeft:l,scrollWidth:s,scrollHeight:a,clientWidth:u,clientHeight:m}=t;e&&d(e.firstChild,{left:l*p(s,u,r,c).ratio}),n&&d(n.firstChild,{top:i*p(a,m,o,c).ratio})}(k.current,w.current,E.current,B,I,u)},{maxWait:8,leading:!0});function O(){k.current&&(L(function(t){const{clientWidth:e,scrollWidth:n,clientHeight:r,scrollHeight:o}=t,{paddingTop:c,paddingRight:i,paddingBottom:l,paddingLeft:s}=window.getComputedStyle(t);return{CW:e,SW:n,CH:r,SH:o,PT:parseInt(c,10),PR:parseInt(i,10),PB:parseInt(l,10),PL:parseInt(s,10)}}(k.current)),F())}return S("mousemove",t=>{if(W.pinX){const e=p(x,X,B,u).ratio;f(k.current,Math.floor(1/e*(t.clientX-W.startX)+W.lastSL),!0)}if(W.pinY){const e=p(M,R,I,u).ratio;f(k.current,Math.floor(1/e*(t.clientY-W.startY)+W.lastST))}},{capture:!0}),S("mouseup",()=>C(y)),function(t,e){const r=g(e,{maxWait:8,leading:!0});n(()=>{const e=new ResizeObserver(()=>{r()});return t.current&&(t.current===document.documentElement?e.observe(document.body):(e.observe(t.current),Array.from(t.current.children).forEach(t=>{e.observe(t)}))),()=>{e.disconnect()}},[t])}(k,O),[N&&t.createElement(b,{visible:H,isGlobal:h,trackStyle:s,thumbStyle:a,minThumbSize:u,start:G,gap:B,horizontal:!0,pin:W.pinX,trackRef:w,boxSize:T,update:C}),A&&t.createElement(b,{visible:H,isGlobal:h,trackStyle:s,thumbStyle:a,minThumbSize:u,start:D,gap:I,pin:W.pinY,trackRef:E,boxSize:T,update:C}),O,F,Y]}function w(e){let{className:n="",onScroll:o,onMouseEnter:c,onMouseLeave:i,innerRef:s,children:a,suppressScrollX:u,suppressScrollY:m,suppressAutoHide:d,skin:p="light",trackGap:f,trackStyle:h,thumbStyle:S,minThumbSize:g,Wrapper:b,...v}=e;const y=r(null);l(s,()=>y.current);const[w,E,T,L,W]=k(y,{trackGap:f,trackStyle:h,thumbStyle:S,minThumbSize:g,suppressAutoHide:d});return t.createElement(b,{className:"ms-container"+(n&&" "+n),ref:y,onScroll:function(t){o&&o(t),L()},onMouseEnter:function(t){c&&c(t),T()},onMouseLeave:function(t){i&&i(t),W()},...v},t.createElement("div",{className:"ms-track-box ms-theme-"+p},!u&&w,!m&&E),a)}const E=s((e,n)=>{let{suppressScrollX:r,suppressScrollY:o,as:c="div",style:i,children:l,...s}=e;const a={overflowX:m(r),overflowY:m(o),...i},d=c;return u()?t.createElement(w,{style:a,innerRef:n,suppressScrollX:r,suppressScrollY:o,Wrapper:d,...s},l):t.createElement(d,{style:a,ref:n,...s},l)});function T(e){let{skin:o="light",...c}=e;const i=function(t){const{current:e}=r({sign:!1,fn:void 0});return e.sign||(e.sign=!0,e.fn=document.createElement("div")),e.fn}();n(()=>{i.classList.add("ms-track-global","ms-theme-"+o),i.classList.remove("ms-theme-"+("light"===o?"dark":"light"));const t="ms-container",e=document.documentElement.classList;return e.add(t),document.body.append(i),()=>{e.remove(t),document.body.removeChild(i)}},[i,o]);const[l,s,u,m]=k(window,c);return S("scroll",()=>{l||s?m():u()}),a(t.createElement(t.Fragment,null,l,s),i)}function L(e){return u()?t.createElement(T,{...e}):null}export{L as GlobalScrollbar,E as MacScrollbar};
//# sourceMappingURL=mac-scrollbar.module.js.map
